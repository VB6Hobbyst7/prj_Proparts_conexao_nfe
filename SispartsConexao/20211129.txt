codMod	Descricao
57	0 - CT-e
55	4 - NF-e Retorno Armazém
55	6 - NF-e Transferência com código Sisparts
55	7 - NF-e Transferência Uso/Consumo com código Sisparts

-------------------------------

Modelo 55

4 - NF-e Retorno Armazém:
tblCompraNF:
ID_NatOp_CompraNF :  tem duas CFOP 1.907 cadastradas em tblNatOper, a correta é que na descrição não tem a palavra Estorno.
A correta é o ID_NatOper = 419 no caso de PSC.
ID_NatOper	Fil_NatOper	CFOP_NatOper	Descr_NatOper
336	                PES	1.907	Ret. mercadoria rem.p/depósito fech ou armz geral
419	                PSC	1.907	Ret. mercadoria rem.p/depósito fech ou armz geral
498	                PSC	1.907	Estorno de Rem. p/ Armaz.

* qryDadosGerais_Update_ID_NatOp_CompraNF
UPDATE tblDadosConexaoNFeCTe SET tblDadosConexaoNFeCTe.ID_NatOp_CompraNF = "419" WHERE (((tblDadosConexaoNFeCTe.ID_NatOp_CompraNF)="498") AND ((tblDadosConexaoNFeCTe.codMod)=55));

-------------------------------

tblCompraNFItem:
(*)ID_Grade_CompraNFItem   é sempre 1 engessado, veio com zero
(**)Almox_CompraNFItem   é o Almox de cada Proparst, eu passei para vc as regras, veio com zero. PSC = 12    PES = 1      PSP = 6

(*)ID_NatOp_CompraNFItem veio com zero, o correto é o mesmo ID da tblCompraNF
(*)CFOP_CompraNFItem veio 5907, o correto é o mesmo CFOP da tblCompraNF

(*)FlagEst_CompraNFItem engessar = 1

(***)ST_CompraNFItem, STIPI_CompraNFItem, STPIS_CompraNFItem e STCOFINS_CompraNFItem vieram vazio, mas deve ser consequencia do ID_NatOp_CompraNFItem que veio com zero

	,"0" & DLookUp("[STICMS_NatOper]", "[tmpNatOp]", "[ID_NatOper] = " & tblDadosConexaoNFeCTe.ID_NatOp_CompraNF & "") AS str_ST_CompraNFItem
	,DLookUp("[STPC_NatOper]", "[tmpNatOp]", "[ID_NatOper] = " & tblDadosConexaoNFeCTe.ID_NatOp_CompraNF & "") AS str_STCOFINS_CompraNFItem
	,DLookUp("[STPC_NatOper]", "[tmpNatOp]", "[ID_NatOper] = " & tblDadosConexaoNFeCTe.ID_NatOp_CompraNF & "") AS str_STPIS_CompraNFItem
	,DLookUp("[STIPI_NatOper]", "[tmpNatOp]", "[ID_NatOper] = " & tblDadosConexaoNFeCTe.ID_NatOp_CompraNF & "") AS str_STIPI_CompraNFItem



(*)BaseCalcICMS_CompraNFItem = 100 engessado, veio zero
(*)BaseCalcICMSSubsTrib_CompraNFItem = 0, veio 50 ????


qryComprasItem_Update_AjustesCampos, qryComprasItem_Update_Almox_CompraNFItem, qryComprasItem_Update_STs



* qryComprasItem_Update_AjustesCampos

	ID_Grade_CompraNFItem   é sempre 1
	FlagEst_CompraNFItem engessar = 1
	BaseCalcICMS_CompraNFItem = 100 engessado
	BaseCalcICMSSubsTrib_CompraNFItem = 0
	ID_NatOp_CompraNFItem veio com zero, o correto é o mesmo ID da tblCompraNF
	CFOP_CompraNFItem veio 5907, o correto é o mesmo CFOP da tblCompraNF
	
** qryComprasItem_Update_Almox_CompraNFItem 
	Almox_CompraNFItem   é o Almox de cada Proparst, eu passei para vc as regras, veio com zero. PSC = 12    PES = 1      PSP = 6
	
*** qryComprasItem_Update_STs


-------------------------------

6 - NF-e Transferência com código Sisparts
tblCompraNF:
ID_NatOp_CompraNF :  tem duas CFOP 2.152 cadastradas em tblNatOper, a correta é que na descrição não tem a palavra Complemento.
A correta é o ID_NatOper = 91 no caso de PSP.
ID_NatOper	Fil_NatOper	CFOP_NatOper	Descr_NatOper
274	                PES	2.152	Entrada Transf. p/ Comercialização
436	                PSC	2.152	Entrada Transf. p/ Comercialização
91	                PSP	2.152	Entrada Transf. p/ Comercialização
122	                PSP	2.152	Complemento de Valores - Transferência

Continuando.....


VTotIPI_CompraNF e VTotProd_CompraNF não estão corretos, conforme imagem acima

Chave que eu testei: 42210368365501000377550000000066921001366297

-------------------------------

tblCompraNFItem:
(*)ID_Grade_CompraNFItem   é sempre 1 engessado, veio com zero
(**)Almox_CompraNFItem   é o Almox de cada Proparst, regras abaixo, veio com zero.

tabEstoqueAlmox:
Codigo_Almox	Desc_Almox	               CodUnid_Almox
97	                ES - Em conferência	PES
98	                SP - Em conferência	PSP
99	                SC - Em conferência	PSC

(*)ID_NatOp_CompraNFItem veio com zero, o correto é o mesmo ID da tblCompraNF
(*)CFOP_CompraNFItem veio 6152, o correto é o mesmo CFOP da tblCompraNF

(***)ST_CompraNFItem, STIPI_CompraNFItem, STPIS_CompraNFItem e STCOFINS_CompraNFItem vieram vazio, mas deve ser consequencia do ID_NatOp_CompraNFItem que veio com zero

(*)FlagEst_CompraNFItem engessar = 1
(*)BaseCalcICMS_CompraNFItem = 100 engessado, veio zero

* qryComprasItem_Update_AjustesCampos

	ID_Grade_CompraNFItem   é sempre 1
	FlagEst_CompraNFItem engessar = 1
	BaseCalcICMS_CompraNFItem = 100 engessado
	BaseCalcICMSSubsTrib_CompraNFItem = 0
	ID_NatOp_CompraNFItem veio com zero, o correto é o mesmo ID da tblCompraNF
	CFOP_CompraNFItem veio 5907, o correto é o mesmo CFOP da tblCompraNF
	
** qryComprasItem_Update_Almox_CompraNFItem
	Almox_CompraNFItem   é o Almox de cada Proparst, regras abaixo, veio com zero.
	
*** qryComprasItem_Update_STs


Chave que eu testei: 42210368365501000377550000000066921001366297

