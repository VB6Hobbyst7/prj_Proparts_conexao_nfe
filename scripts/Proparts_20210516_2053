
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS00").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS00").Item(0).getElementsByTagName("CST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS00").Item(0).getElementsByTagName("modBC").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS00").Item(0).getElementsByTagName("vBC").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS00").Item(0).getElementsByTagName("pICMS").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS00").Item(0).getElementsByTagName("vICMS").Item(0).text


XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS10").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS10").Item(0).getElementsByTagName("CST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS10").Item(0).getElementsByTagName("modBC").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS10").Item(0).getElementsByTagName("vBC").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS10").Item(0).getElementsByTagName("pICMS").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS10").Item(0).getElementsByTagName("vICMS").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS10").Item(0).getElementsByTagName("modBCST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS10").Item(0).getElementsByTagName("pMVAST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS10").Item(0).getElementsByTagName("pRedBCST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS10").Item(0).getElementsByTagName("vBCST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS10").Item(0).getElementsByTagName("pICMSST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS10").Item(0).getElementsByTagName("vICMSST").Item(0).text


XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS20").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS20").Item(0).getElementsByTagName("CST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS20").Item(0).getElementsByTagName("modBC").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS20").Item(0).getElementsByTagName("vBC").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS20").Item(0).getElementsByTagName("pICMS").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS20").Item(0).getElementsByTagName("vICMS").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS20").Item(0).getElementsByTagName("pRedBC").Item(0).text


XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS30").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS30").Item(0).getElementsByTagName("CST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS30").Item(0).getElementsByTagName("modBCST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS30").Item(0).getElementsByTagName("pMVAST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS30").Item(0).getElementsByTagName("pRedBCST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS30").Item(0).getElementsByTagName("vBCST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS30").Item(0).getElementsByTagName("pICMSST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS30").Item(0).getElementsByTagName("vICMSST").Item(0).text


XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS40").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS40").Item(0).getElementsByTagName("CST").Item(0).text


XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS41").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS41").Item(0).getElementsByTagName("CST").Item(0).text



XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS50").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS50").Item(0).getElementsByTagName("CST").Item(0).text


XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS51").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS51").Item(0).getElementsByTagName("CST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS51").Item(0).getElementsByTagName("modBC").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS51").Item(0).getElementsByTagName("vBC").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS51").Item(0).getElementsByTagName("pICMS").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS51").Item(0).getElementsByTagName("vICMS").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS51").Item(0).getElementsByTagName("pRedBC").Item(0).text


XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS60").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS60").Item(0).getElementsByTagName("CST").Item(0).text


XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS70").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS70").Item(0).getElementsByTagName("CST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS70").Item(0).getElementsByTagName("modBC").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS70").Item(0).getElementsByTagName("vBC").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS70").Item(0).getElementsByTagName("pICMS").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS70").Item(0).getElementsByTagName("vICMS").Item(0).text

XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS70").Item(0).getElementsByTagName("pRedBC").Item(0).text
modBXMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS70").Item(0).getElementsByTagName("modBCST").Item(0).text

XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS70").Item(0).getElementsByTagName("pMVAST").Item(0).text
BXMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS70").Item(0).getElementsByTagName("pRedBCST").Item(0).text
BXMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS70").Item(0).getElementsByTagName("vBCST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS70").Item(0).getElementsByTagName("pICMSST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS70").Item(0).getElementsByTagName("vICMSST").Item(0).text


XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS90").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS90").Item(0).getElementsByTagName("CST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS90").Item(0).getElementsByTagName("modBC").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS90").Item(0).getElementsByTagName("vBC").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS90").Item(0).getElementsByTagName("pICMS").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS90").Item(0).getElementsByTagName("vICMS").Item(0).text
pRedBC = XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS90").Item(0).getElementsByTagName("pRedBC").Item(0).text

modBXMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS90").Item(0).getElementsByTagName("modBCST").Item(0).text

pMVAST = XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS90").Item(0).getElementsByTagName("pMVAST").Item(0).text

pRedBXMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS90").Item(0).getElementsByTagName("pRedBCST").Item(0).text
vBXMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS90").Item(0).getElementsByTagName("vBCST").Item(0).text

XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS90").Item(0).getElementsByTagName("pICMSST").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMS90").Item(0).getElementsByTagName("vICMSST").Item(0).text


XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMSSN102").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMSSN102").Item(0).getElementsByTagName("CSOSN").Item(0).text
'ICMSSN 500
ElseIf XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMSSN500").Length > 0 Then
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMSSN500").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMSSN500").Item(0).getElementsByTagName("CSOSN").Item(0).text


XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMSSN101").Item(0).getElementsByTagName("orig").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMSSN101").Item(0).getElementsByTagName("CSOSN").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMSSN101").Item(0).getElementsByTagName("pCredSN").Item(0).text
XMLdoc.SelectNodes("nfeProc/NFe/infNFe/det").Item(i).SelectNodes("imposto/ICMS/ICMSSN101").Item(0).getElementsByTagName("vCredICMSSN").Item(0).text

