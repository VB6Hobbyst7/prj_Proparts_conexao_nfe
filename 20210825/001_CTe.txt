Segue abaixo a função atual do meu sistema que gera o CTe no banco de dados, vai ajudar a preencher todos os campos que ficaram vazios ou divergentes.
Segue em anexo planilha com alguns CTes importados pela sua função em comparação com o que já estava correto no banco de dados SispartsN para vc comparar e corrigir sua função.
Na planilha tbm tem os itens equivalentes no SispartsN, assim vc consegue comparar se está fazendo correto.
 
 
Encontrar o IDCadFor
strSQL = "SELECT Clientes.CNPJ_CPF, Clientes.CÓDIGOClientes AS ID_Cad " _
& "FROM Clientes " _
& "WHERE  (Clientes.CNPJ_CPF='" & Format(XMLCNPJEmi, "00\.000\.000/0000\-00") & "') ;"
'SaveSQLString strSQL
rsCad.CursorType = adOpenKeyset
rsCad.LockType = adLockOptimistic
rsCad.CursorLocation = adUseClient
rsCad.Open strSQL, CNN, , , adCmdText
If rsCad.RecordCount = 0 Then
    MsgBox "Fornecedor não cadastrado !" & Chr(10) & "CNPJ: " & XMLCNPJEmi, vbInformation, "Atenção"
    rsCad.Close
    Exit Sub
Else
    IDCadFor = rsCad!ID_Cad
End If
 
Se o CTe já existe no banco de dados não importar novamente
strSQL = "SELECT Clientes.CNPJ_CPF, tblCompraNF.ID_Forn_CompraNF, tblCompraNF.NumNF_CompraNF, tblCompraNF.DTEntd_CompraNF " _
& "FROM tblCompraNF INNER JOIN Clientes ON tblCompraNF.ID_Forn_CompraNF = Clientes.CÓDIGOClientes " _
& "WHERE  (Clientes.CNPJ_CPF='" & Format(XMLCNPJEmi, "00\.000\.000/0000\-00") & "') AND (tblCompraNF.NumNF_CompraNF=" & XMLNumNF & ");"
rsCompraNF.CursorType = adOpenKeyset
rsCompraNF.LockType = adLockOptimistic
rsCompraNF.CursorLocation = adUseClient
rsCompraNF.Open strSQL, CNN, , , adCmdText
If rsCompraNF.RecordCount > 0 Then
    'MsgBox Me.Finalidade.Column(1) & " já importad" & IIf(Me.Finalidade.Column(0) = 0, "o", "a") & "  !", vbInformation, "Atenção"
    strXMLjaImp = strXMLjaImp & XMLNumNF & " - Data Entrada: " & rsCompraNF!DTEntd_CompraNF & Chr(10)
    'Contador XML's já importados
    CountXMLImp = CountXMLImp + 1
    rsCompraNF.Close
    Exit Sub
End If
rsCompraNF.Close
 
 
 
Importando CTe
 
If Me.Finalidade = 0 Then 'CT-e
 
    Escolhendo o ID da CFOP na tabela tblNatOp para o CTe conforme a empresa PSC, PES ou PSC
 
    If Me.FiltroFil = "PSP" Then
        'Cadastro de Empresa
        rsEmp.CursorLocation = adUseClient
        rsEmp.CursorType = adOpenKeyset
        rsEmp.LockType = adLockOptimistic
        rsEmp.Open "SELECT tblEmpresa.UF_Empresa FROM tblEmpresa WHERE tblEmpresa.CNPJ_Empresa='" & Forms!frmCompraNF_ImpXML!txtCNPJRem & "'", CNN
       
        If Me.txtUFEmit = rsEmp!UF_Empresa Then   'DLookup("[UF_Empresa]", "tblEmpresa", "[CNPJ_Empresa]='" & Forms!frmCompraNF_ImpXML!txtCNPJRem & "'")
            Me.FiltroCFOP = DLookup("[ID_NatOper]", "tblNatOp", "[CFOP_NatOper]='1.353' and [Fil_NatOper]='" & Me.FiltroFil & "'")
            Me.FiltroCFOP.Requery
        ElseIf Me.txtUFEmit <> rsEmp!UF_Empresa Then  'DLookup("[UF_Empresa]", "tblEmpresa", "[CNPJ_Empresa]='" & Forms!frmCompraNF_ImpXML!txtCNPJRem & "'")
            Me.FiltroCFOP = DLookup("[ID_NatOper]", "tblNatOp", "[CFOP_NatOper]='2.353' and [Fil_NatOper]='" & Me.FiltroFil & "'")
            Me.FiltroCFOP.Requery
        End If
        rsEmp.Close
        If XMLCFOP = "7358" Then
            Me.FiltroCFOP = DLookup("[ID_NatOper]", "tblNatOp", "[CFOP_NatOper]='3.353' and [Fil_NatOper]='" & Me.FiltroFil & "'")
            Me.FiltroCFOP.Requery
        End If
       
        
    ElseIf Me.FiltroFil = "PSC" Then
         If XMLCFOP = "5353" Then '1353
            Me.FiltroCFOP = DLookup("[ID_NatOper]", "tblNatOp", "[CFOP_NatOper]='1.353' and [Fil_NatOper]='" & Me.FiltroFil & "'")
            Me.FiltroCFOP.Requery
        ElseIf XMLCFOP = "6353" Then '2353
            Me.FiltroCFOP = DLookup("[ID_NatOper]", "tblNatOp", "[CFOP_NatOper]='2.353' and [Fil_NatOper]='" & Me.FiltroFil & "'")
            Me.FiltroCFOP.Requery
        ElseIf XMLCFOP = "7358" Then
            Me.FiltroCFOP = DLookup("[ID_NatOper]", "tblNatOp", "[CFOP_NatOper]='3.353' and [Fil_NatOper]='" & Me.FiltroFil & "'")
            Me.FiltroCFOP.Requery
        End If
    ElseIf Me.FiltroFil = "PES" Then
         If XMLCFOP = "5353" Then '1353
            Me.FiltroCFOP = DLookup("[ID_NatOper]", "tblNatOp", "[CFOP_NatOper]='1.353' and [Fil_NatOper]='" & Me.FiltroFil & "'")
            Me.FiltroCFOP.Requery
        ElseIf XMLCFOP = "6353" Then '2353
            Me.FiltroCFOP = DLookup("[ID_NatOper]", "tblNatOp", "[CFOP_NatOper]='2.353' and [Fil_NatOper]='" & Me.FiltroFil & "'")
            Me.FiltroCFOP.Requery
        ElseIf XMLCFOP = "7358" Then
            Me.FiltroCFOP = DLookup("[ID_NatOper]", "tblNatOp", "[CFOP_NatOper]='3.353' and [Fil_NatOper]='" & Me.FiltroFil & "'")
            Me.FiltroCFOP.Requery
        End If
    End If
   
 
   
    rsCompraNF.CursorType = adOpenKeyset
    rsCompraNF.LockType = adLockOptimistic
    rsCompraNF.CursorLocation = adUseClient
    rsCompraNF.Open "SELECT TOP 1 * FROM tblCompraNF", CNN, , , adCmdText
   
    rsCompraNF.AddNew
    OK | rsCompraNF!Fil_CompraNF = Me.FiltroFil
    OK | rsCompraNF!NumNF_CompraNF = XMLNumNF
 
   Numero do pedido é único, tem que buscar o ultimo número e salvar no campo a cada insert de CTe
    OK | rsCompraNF!NumPed_CompraNF = Format(IIf(IsNull(DMax("NumPed_CompraNF", "tblCompraNF")), "000001", DMax("NumPed_CompraNF", "tblCompraNF") + 1), "000000")
    OK | rsCompraNF!ModeloDoc_CompraNF = 57
    OK | rsCompraNF!Serie_CompraNF = XMLSerie
    OK | rsCompraNF!TPNF_CompraNF = 1
    OK | rsCompraNF!ID_NatOp_CompraNF = Me.FiltroCFOP.Column(0)
    OK | rsCompraNF!CFOP_CompraNF = Me.FiltroCFOP.Column(1)
    OK | rsCompraNF!DTEmi_CompraNF = XMLDTEmi
    
	Data do dia da importação do CTe
    OK | rsCompraNF!DTEntd_CompraNF = Date
 
    ID do Fornecedor na tabela [Clientes]
    OK | rsCompraNF!ID_Forn_CompraNF = IDCadFor
 
    OK | rsCompraNF!BaseCalcICMS_CompraNF = XMLBCICMS
    OK | rsCompraNF!VTotICMS_CompraNF = XMLValICMS
    OK | rsCompraNF!VTotServ_CompraNF = 0
    OK | rsCompraNF!VTotProd_CompraNF = XMLValNF
    OK | rsCompraNF!VTotNF_CompraNF = XMLValNF
    OK | rsCompraNF!Sit_CompraNF = 6
    OK | rsCompraNF!ChvAcesso_CompraNF = XMLChave
    OK | rsCompraNF!BaseCalcICMSSubsTrib_CompraNF = 0
    OK | rsCompraNF!VTotICMSSubsTrib_CompraNF = 0
    OK | rsCompraNF!VTotFrete_CompraNF = 0
    OK | rsCompraNF!VTotSeguro_CompraNF = 0
    OK | rsCompraNF!VTotOutDesp_CompraNF = 0
    OK | rsCompraNF!VTotIPI_CompraNF = 0
    OK | rsCompraNF!VTotISS_CompraNF = 0
    OK | rsCompraNF!TxDesc_CompraNF = 0
    OK | rsCompraNF!VTotDesc_CompraNF = 0
    OK | rsCompraNF!VTotISS_CompraNF = 0
    OK | rsCompraNF!VTotISS_CompraNF = 0
   
    rsCompraNF.Update
    IDCompraNF = rsCompraNF!ID_CompraNF
   
    rsCompraNF.Close
    rsCad.Close
 
    Incluindo o produto no CTe
    rsCompraNFItem.CursorType = adOpenKeyset
    rsCompraNFItem.LockType = adLockOptimistic
    rsCompraNFItem.CursorLocation = adUseClient
    rsCompraNFItem.Open "SELECT TOP 1 * FROM tblCompraNFItem", CNN, , , adCmdText
   
    rsCompraNFItem.AddNew
    rsCompraNFItem!ID_CompraNF_CompraNFItem = IDCompraNF
    rsCompraNFItem!Item_CompraNFItem = 1
   
    Localizando o ID do produto na tabela "[Cadastro de Produtos]
    rsCompraNFItem!ID_Prod_CompraNFItem = DLookup("[Código]", "[Cadastro de Produtos]", "[Modelo]='TRANSPORTE'")
   
    rsCompraNFItem!ID_Grade_CompraNFItem = 1
    rsCompraNFItem!Almox_CompraNFItem = Forms!frmCompraNF_ImpXML!FiltroAlmox
   
    rsCompraNFItem!QtdFat_CompraNFItem = 1
    rsCompraNFItem!VUnt_CompraNFItem = XMLValNF
    rsCompraNFItem!ICMS_CompraNFItem = XMLPerICMS
    rsCompraNFItem!ISS_CompraNFItem = 0
    rsCompraNFItem!IPI_CompraNFItem = 0
    rsCompraNFItem!CFOP_CompraNFItem = Me.FiltroCFOP.Column(1)
    rsCompraNFItem!ST_CompraNFItem = "0" & Me.FiltroCFOP.Column(4)
    rsCompraNFItem!FlagEst_CompraNFItem = 0
    rsCompraNFItem!DTEmi_CompraNFItem = XMLDTEmi
    rsCompraNFItem!Num_CompraNFItem = XMLNumNF
    rsCompraNFItem!VTot_CompraNFItem = XMLValNF
    rsCompraNFItem!BaseCalcICMS_CompraNFItem = 100
    rsCompraNFItem!DebICMS_CompraNFItem = XMLValICMS
   
    rsCompraNFItem!IseICMS_CompraNFItem = 0
    rsCompraNFItem!OutICMS_CompraNFItem = 0
    rsCompraNFItem!BaseCalcIPI_CompraNFItem = 0
    rsCompraNFItem!DebIPI_CompraNFItem = 0
    rsCompraNFItem!IseIPI_CompraNFItem = 0
    rsCompraNFItem!OutIPI_CompraNFItem = 0
    rsCompraNFItem!TxMLSubsTrib_CompraNFItem = 0
    rsCompraNFItem!TxIntSubsTrib_CompraNFItem = 0
    rsCompraNFItem!TxExtSubsTrib_CompraNFItem = 0
    rsCompraNFItem!BaseCalcICMSSubsTrib_CompraNFItem = 0
    rsCompraNFItem!VTotICMSSubsTrib_compranfitem = 0
    rsCompraNFItem!VTotFrete_CompraNFItem = 0
    rsCompraNFItem!VTotDesc_CompraNFItem = 0
    rsCompraNFItem!VTotFrete_CompraNFItem = 0
    rsCompraNFItem!VTotBaseCalcICMS_CompraNFItem = XMLBCICMS
    rsCompraNFItem!ID_NatOp_CompraNFItem = Me.FiltroCFOP.Column(0)
    rsCompraNFItem!VTotPIS_CompraNFItem = 0
    rsCompraNFItem!STPIS_CompraNFItem = Me.FiltroCFOP.Column(6)
    rsCompraNFItem!VTotBaseCalcPIS_CompraNFItem = 0
    rsCompraNFItem!VTotCOFINS_CompraNFItem = 0
    rsCompraNFItem!STCOFINS_CompraNFItem = Me.FiltroCFOP.Column(6)
    rsCompraNFItem!VTotBaseCalcCOFINS_CompraNFItem = 0
   
    rsCompraNFItem!STIPI_CompraNFItem = Me.FiltroCFOP.Column(5)
    rsCompraNFItem!VTotIseICMS_CompraNFItem = 0
    rsCompraNFItem!VTotBaseCalcCOFINS_CompraNFItem = 0
    rsCompraNFItem!SNCredICMS_CompraNFItem = 0
    rsCompraNFItem!VTotSNCredICMS_CompraNFItem = 0
    rsCompraNFItem!VTotSeg_CompraNFItem = 0
    rsCompraNFItem!VTotOutDesp_CompraNFItem = 0
    rsCompraNFItem.Update
    rsCompraNFItem.Close
	
	
-------------------------
	